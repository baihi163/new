# Task 5: Instance Segmentation (实例分割) - 任务解读与实施计划

## 1. 任务综述 (Task Overview)

**实例分割 (Instance Segmentation)** 是计算机视觉领域中难度较高的任务之一，它结合了 **目标检测 (Object Detection)** 和 **语义分割 (Semantic Segmentation)** 的特点。

*   **目标检测**：不仅要像分类任务一样识别出图像中的物体，还要用边界框 (Bounding Box) 将其定位。
*   **语义分割**：不仅要定位，还要对框内的物体进行像素级的分类，精确地描绘出物体的轮廓 (Mask/掩码)。

简单来说，任务三（分类）是告诉机器“图里有人”，任务五则是要求机器“把人的形状精确地抠出来”。

---

## 2. 核心目标 (Core Objectives)

根据《UD_Lab 2025 寒假招新考核说明》，本任务的具体要求如下：

*   **输入**：一张包含目标的图片（使用 Penn-Fudan Pedestrian 数据集）。
*   **输出**：
    1.  **检测框 (BBox)**：定位目标的位置。
    2.  **掩码 (Mask)**：覆盖目标的精确轮廓。
    3.  **可视化**：将原图、预测框、预测掩码叠加展示。

---

## 3. 技术路线与评分标准 (Technical Route & Grading)

考核说明明确区分了“及格做法”和“高分做法”。为了获得更好的评价，本项目选择 **高分/进阶路线**。

| 维度 | 低分/及格路线 📉 | **本项目采用的高分路线** 🚀 |
| :--- | :--- | :--- |
| **工具选择** | 使用高度封装的工具库（如 YOLOv8, PaddleX）。 | **基于 PyTorch 框架，使用 `torchvision` 手写网络。** |
| **实现方式** | “一行命令式”调用，黑盒操作。 | **源码级微调 (Fine-tuning)**，自定义 Dataset 类，修改模型头部 (Head)。 |
| **体现能力** | 仅体现会使用工具，无法证明懂原理。 | **体现对底层数据处理、网络架构（如 Mask R-CNN）的深刻理解。** |
| **模型架构** | YOLO 系列 | **Mask R-CNN** (基于 ResNet-50-FPN) |

**我们的策略**：
我们将使用 PyTorch 的 `torchvision.models` 加载预训练的 Mask R-CNN，并根据 Penn-Fudan 数据集自定义数据加载器（Dataset）和模型结构，对预训练模型的分类器和 Mask 预测器进行微调。

---

## 4. 难点与思考 (Challenges & Thoughts)

*(在此处记录你在实验过程中的思考，以下是预设的思考方向)*

### A. 数据处理的差异
*   **分类任务 (Task 3)**：标签是一个整数（例如 `1` 代表猫）。
*   **分割任务 (Task 5)**：标签是一张 **图像 (Mask)**。
    *   Mask 是一个二维矩阵，像素值 `0` 代表背景，`1` 代表目标物体。
    *   **难点**：如何把下载下来的彩色 Mask 图片（RGB）转换成模型需要的 0/1 矩阵？如何处理一张图里有多个人的情况（Instance 区分）？
    *   **解决方案**：*(待填写：例如使用 `np.unique` 获取所有实例 ID，生成二进制掩码)*

### B. 模型架构的理解
*   **Mask R-CNN** 是在 Faster R-CNN（检测模型）的基础上增加一个分支来预测 Mask 的。
*   **RoI Align**：这是 Mask R-CNN 的核心创新点，解决了 RoI Pooling 中的量化误差问题，实现了像素级的对齐。

---

## 5. 实施步骤 (Implementation Steps)

1.  **数据准备**：下载并解压 Penn-Fudan 数据集，编写自定义 Dataset 类。
2.  **模型搭建**：加载预训练 Mask R-CNN 模型，修改头部以适应 2 类（背景 + 行人）。
3.  **训练循环**：编写 Train Loop，使用 SGD 优化器进行微调。
4.  **评估与可视化**：在测试集上评估模型性能，并可视化预测结果。

---

## 6. 预期成果 (Expected Outcome)

通过本次任务，我将深入理解实例分割的原理，掌握 PyTorch 中自定义 Dataset 和微调复杂模型的方法。最终提交一份包含代码、训练日志和可视化结果的完整报告。